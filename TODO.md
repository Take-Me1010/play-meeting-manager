# 交流会対戦管理アプリ - 実装計画

## 要件・満たしたいユースケース

- スプレッドシートで、デュエルマスターズの対戦を管理するアプリ
  - 対戦は、n回戦の概念があり、それぞれでユーザーを対戦に割り当てる
  - 対戦は、何回戦か・対戦ユーザー１・対戦ユーザー２
- 主催者（管理者）は、対戦をスプレッドシートに設定して、n回戦の始まり・終わりを管理できる
- ユーザーは、初回に名前を設定する
- ユーザーには、対戦者と観戦者のロールがある
- ユーザーは、管理者がn回戦を開始した後に、対戦表を表示できる
- 対戦者は、勝敗報告を行う。必ず勝者が報告を行う。

### スプレッドシート構成

必要な sheet (DB における table) 設計
- users
  - id
  - name
  - email
- matches
  - round: 何回戦か
  - winner_user_id: 勝者ユーザー
  - finished: 試合の状況
- match_opponents
  - match_id: 紐づく matches
  - user_id: 紐づく users
- match_results
  - match_id: 紐づく matches
  - winner_user_id: 勝者ユーザー
  - finished: 試合の状況

- matches -> match_opponents は 1:2 の関係になる想定
  - 試合は2人で行うため。

## 環境設定・初期セットアップ

- [x] プロジェクト構造の作成
  - [x] frontend/ ディレクトリにReact + Vite + TypeScriptプロジェクト作成
  - [x] backend/ ディレクトリにGoogle Apps Scriptプロジェクト作成
  - [x] dist/ ディレクトリ作成
- [x] 開発環境の設定
  - [x] package.jsonのビルドスクリプト設定
  - [x] TypeScript設定ファイル作成
- [x] フロントエンド依存関係の設定
  - [x] Material UI インストール・設定

## バックエンド（Google Apps Script）実装

### スプレッドシート設計・初期化
- [ ] スプレッドシート構造の実装
  - [ ] usersシート作成（id, name, email）
  - [ ] matchesシート作成（round, winner_user_id, finished）
  - [ ] match_opponentsシート作成（match_id, user_id）
  - [ ] match_resultsシート作成（match_id, winner_user_id, finished）

### API実装
- [ ] ユーザー管理API
  - [ ] ユーザー登録（名前・メール）
  - [ ] ユーザー一覧取得
  - [ ] ユーザー情報更新
- [ ] 試合管理API
  - [ ] 回戦開始・終了管理
  - [ ] 対戦組み合わせ生成・設定
  - [ ] 対戦表取得
- [ ] 勝敗報告API
  - [ ] 勝敗結果登録
  - [ ] 試合結果取得・更新

### 認証・権限管理
- [x] Google認証機能実装
- [ ] ユーザーロール管理（対戦者・観戦者）
- [ ] 管理者権限チェック機能（特定のGoogleアカウントのみ）（一旦不要）

## フロントエンド（React + TypeScript）実装

### 基本構成
- [x] ルーティング設定（React Router）
- [x] Material UI テーマ設定・レスポンシブ対応
- [x] 状態管理（Context API）設定


### ユーザー機能
- [x] Google認証ログイン画面
- [x] ユーザー情報表示・編集画面（名前設定）
- [x] ロール選択画面（対戦者・観戦者）

<!-- ### 管理者機能
- [ ] 管理者ダッシュボード
- [ ] 回戦開始・終了操作画面
- [ ] 対戦組み合わせ確認画面（スプレッドシート手動設定後の確認）
- [ ] 全体の試合状況確認画面 -->

### 対戦者機能
- [x] 対戦表表示画面
- [x] 勝敗報告画面

### 観戦者機能
- [x] 対戦表閲覧画面
- [x] 試合結果閲覧画面

<!-- ## 統合・テスト・デプロイ

- [ ] フロントエンドとバックエンドの連携テスト
- [ ] ユーザーシナリオテスト
  - [ ] 管理者による回戦管理フロー
  - [ ] 対戦者による勝敗報告フロー
  - [ ] 観戦者による閲覧フロー
- [ ] ビルド・デプロイ設定
  - [ ] frontend, backendのビルドプロセス
  - [ ] dist/への出力設定
  - [ ] clasp deploy設定 -->

<!-- ## 追加機能・改善（オプション）

- [ ] 対戦履歴の統計表示
- [ ] エクスポート機能（CSV等）
- [ ] リアルタイム更新機能
- [ ] モバイル対応改善
- [ ] エラーハンドリング強化 -->

## 実装方針

- **認証**: Google認証のみを使用
- **UI**: Material UIでレスポンシブデザイン対応
- **対戦組み合わせ**: 管理者がスプレッドシートを直接操作、アプリは確認・表示のみ
- **デプロイ**: clasp経由でGoogle Apps Scriptにデプロイ
